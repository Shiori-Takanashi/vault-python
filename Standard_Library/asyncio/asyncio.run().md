### ✅ `asyncio.run()` とは？

> **非同期処理を開始するためのエントリポイント関数**です。
> **`async def` で定義された関数（= コルーチン）を一度だけ実行するための最も安全な方法**です。

---

## ✅ 一言で言えば

> **「イベントループを作って、コルーチンを1回実行して、ループを閉じる関数」**。

---

## ✅ 使用例

```python
import asyncio

async def hello():
    await asyncio.sleep(1)
    print("こんにちは")

asyncio.run(hello())
```

出力：

```
（1秒後）
こんにちは
```

---

## ✅ `asyncio.run()` が内部でしていること

1. 新しいイベントループを作る
2. 指定されたコルーチンを登録して実行する
3. 全部終わったらイベントループを閉じる

→ **ユーザはループの管理を気にしなくてよい**

---

## ✅ 使える場所と制限

| 条件             | 可否   | 理由                   |
| -------------- | ---- | -------------------- |
| スクリプトの先頭関数として  | ✅ OK | 通常の使い方               |
| `async def` の外 | ✅ OK | これは同期関数だから使える        |
| `async def` の中 | ❌ NG | **既にループが動いているためエラー** |

---

### ❌ これはエラーになる：

```python
async def inner():
    asyncio.run(other())  
    # ❌ RuntimeError: asyncio.run() cannot be called from a running event loop
```

---

## ✅ 代替：ループの中で呼びたいなら

* `await other()` にするか
* 明示的に `get_running_loop().create_task(...)` などを使う

---

## ✅ 主な用途まとめ

| シーン            | 使用目的                       |
| -------------- | -------------------------- |
| スクリプトのエントリポイント | 非同期処理の入口として `main()` を実行する |
| テスト関数やワンショット実行 | 一度きりの非同期処理を実行したい           |
| CLI系ツール        | 非同期API・DBなどとやり取りする処理の起点に最適 |

---

## ✅ まとめ

> `asyncio.run()` は、**非同期処理の公式な開始点**。
> イベントループの初期化から終了までを自動で管理し、**1回限りの非同期処理実行**に適している。
> **`await` できない場所でコルーチンを実行したいときに使う**。

---

必要であれば、`asyncio.run()` の内部構造（`new_event_loop()` → `set_event_loop()` → `run_until_complete()`）なども提示可能です。希望があればどうぞ。
