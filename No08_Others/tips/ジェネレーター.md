> ## ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã®åŸºæœ¬

---

> ### ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã¨ã¯

* **ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ä¸€ç¨®**
* `__iter__()` ã¨ `__next__()` ã‚’è‡ªå‹•çš„ã«æŒã¤
* `yield` ã‚’ä½¿ã£ã¦ã€å€¤ã‚’**é€æ¬¡çš„ã«è¿”ã™é–¢æ•°**ã§ä½œæˆ
* çŠ¶æ…‹ã‚’ä¿æŒã—ãŸã¾ã¾ **ä¸­æ–­ â†’ å†é–‹** ãŒå¯èƒ½
* **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãŒè‰¯ãã€ãƒªã‚¹ãƒˆå…¨ä½“ã‚’ä¿æŒã—ãªã„**

---

> ### ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ â‰  ã‚¤ãƒ†ãƒ©ãƒ–ãƒ« â‰  ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãƒ¼

| æ¦‚å¿µ      | èª¬æ˜                    | å®Ÿè£…è¦ä»¶                        |
| ------- | --------------------- | --------------------------- |
| ã‚¤ãƒ†ãƒ©ãƒ–ãƒ«   | `for` ã§å›ã›ã‚‹ã‚‚ã®          | `__iter__()` ã‚’æŒã¤            |
| ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãƒ¼  | `next()` ã§1ã¤ãšã¤å–ã‚Šå‡ºã›ã‚‹ã‚‚ã® | `__iter__()` + `__next__()` |
| ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ | `yield` ã§å€¤ã‚’è¿”ã™ç‰¹æ®Šãªé–¢æ•°    | å®Ÿè¡Œã™ã‚‹ã¨ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’è¿”ã™              |

```python
def g():
    yield 1
gen = g()

isinstance(gen, Iterator)  # True
isinstance(gen, Iterable)  # True
```

---

> ### é€šå¸¸ã®é–¢æ•°ã¨ã®é•ã„

| æ¯”è¼ƒå¯¾è±¡    | é€šå¸¸ã®é–¢æ•°    | ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼             |
| ------- | -------- | ------------------- |
| ä½¿ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ | `return` | `yield`             |
| æˆ»ã‚Šå€¤     | å€¤        | ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼ˆã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼‰     |
| å®Ÿè¡Œæ™‚ã®å‹•ä½œ  | å…¨ä½“ã‚’ä¸€åº¦ã«å®Ÿè¡Œ | `yield` ã§ä¸­æ–­ã—ãªãŒã‚‰é€æ¬¡å®Ÿè¡Œ |
| çŠ¶æ…‹ã®ä¿æŒ   | æ¯å›åˆæœŸåŒ–ã•ã‚Œã‚‹ | é€”ä¸­ã®çŠ¶æ…‹ã‚’ä¿æŒã—ã¦å†é–‹å¯èƒ½      |

---

> ### åŸºæœ¬æ§‹æ–‡ã¨å‹•ä½œ

```python
def count_up_to(n):
    i = 1
    while i <= n:
        yield i
        i += 1

gen = count_up_to(3)
next(gen)  # 1
next(gen)  # 2
next(gen)  # 3
next(gen)  # StopIteration
```

---

> ### `for` æ–‡ã¨ã®ä½µç”¨ï¼ˆæ¨å¥¨ï¼‰

```python
for val in count_up_to(3):
    print(val)  # 1, 2, 3
```

âœ… `for` æ–‡ã¯å†…éƒ¨ã§ `next()` ã‚’ä½¿ã„ã€`StopIteration` ã‚’è‡ªå‹•å‡¦ç†ã™ã‚‹ãŸã‚å®‰å…¨ã€‚

---

> ### ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼å¼ï¼ˆgenerator expressionï¼‰

```python
gen = (x * x for x in range(3))

next(gen)  # 0
next(gen)  # 1
next(gen)  # 4
```

* `()` ã§å›²ã‚€ã¨ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼å¼
* `[]` ã®ãƒªã‚¹ãƒˆå†…åŒ…è¡¨è¨˜ã¨ä¼¼ã¦ã„ã‚‹ãŒã€**é…å»¶è©•ä¾¡ã•ã‚Œãƒ¡ãƒ¢ãƒªã‚’æ¶ˆè²»ã—ãªã„**

---

> ### ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã¨ä¸»ãªç”¨é€”

* è¦ç´ æ•°ãŒå¤šã„å ´åˆã§ã‚‚ **ä¸€åº¦ã«å…¨ä½“ã‚’ä¿æŒã—ãªã„**
* ãƒ•ã‚¡ã‚¤ãƒ«ã®è¡Œå‡¦ç†ãƒ»ã‚¹ãƒˆãƒªãƒ¼ãƒ å‡¦ç†ãƒ»å·¨å¤§ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã«é©ã™ã‚‹
* è¤‡é›‘ãªãƒ«ãƒ¼ãƒ—çŠ¶æ…‹ã®ç®¡ç†ã‚„ã€å†é–‹å¯èƒ½ãªå‡¦ç†ã«ã‚‚å‘ã

---

> ### `yield` ã¨ `return` ã®ä½µç”¨

```python
def example():
    yield 1
    return 99

gen = example()
next(gen)      # 1
next(gen)      # StopIteration(99)
```

* `return` ã§çµ‚äº†ã™ã‚‹ã¨ `StopIteration(value)` ãŒç™ºç”Ÿã—ã€`value` ã¯ `.args[0]` ã«æ ¼ç´ã•ã‚Œã‚‹

---

> ### `yield from`ï¼šå…¥ã‚Œå­ã®å±•é–‹

```python
def sub():
    yield 1
    yield 2

def main():
    yield from sub()
    yield 3

list(main())  # [1, 2, 3]
```

ğŸ“Œ `yield from` ã¯ã€Œã‚µãƒ–ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®è¦ç´ ã‚’ã™ã¹ã¦é †ã«yieldã™ã‚‹ã€æ§‹æ–‡ç³–è¡£

---

> ### è£œè¶³ï¼šã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ä¸€åº¦ãã‚Š

```python
gen = (x for x in range(3))
list(gen)  # [0, 1, 2]
list(gen)  # []ï¼ˆã™ã§ã«æ¶ˆè²»ã•ã‚ŒãŸãŸã‚ç©ºï¼‰
```

âœ… ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã€Œæ¶ˆè²»å‹ã€ã€‚å†åˆ©ç”¨ã¯ã§ããªã„ã€‚

---

> ### ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã®æ¤œå‡º

```python
from collections.abc import Iterator, Iterable
from types import GeneratorType

def gen(): yield 1

g = gen()

isinstance(g, GeneratorType)  # True
isinstance(g, Iterator)       # True
isinstance(g, Iterable)       # True
```

---
