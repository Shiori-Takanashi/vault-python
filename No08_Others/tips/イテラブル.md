> # イテラブル（iterable）とは

* **for文で繰り返し可能なオブジェクト**
* 内部に `__iter__()` メソッドを持つ
* `iter(obj)` で **イテレーターに変換できる**

```python
lst = [1, 2, 3]
it = iter(lst)  # イテラブルからイテレーターへ
```

---

> ### 主なイテラブルの一覧（組み込み）

| 型               | 内容             | 備考                      |
| --------------- | -------------- | ----------------------- |
| `list`          | リスト            | `[1, 2, 3]`             |
| `tuple`         | タプル            | `(1, 2, 3)`             |
| `str`           | 文字列            | `"abc"` → `'a','b','c'` |
| `dict`          | 辞書のキー          | `{"a": 1}` → `'a'`      |
| `set`           | セット（集合）        | `{1, 2, 3}`             |
| `range`         | 整数の連続値         | `range(5)`              |
| `enumerate`     | 添字付きのイテラブル生成器  | `enumerate(["a", "b"])` |
| `zip`           | 複数イテラブルをまとめる   | `zip([1,2],[3,4])`      |
| `reversed`      | 逆順のイテラブル       | `reversed([1,2,3])`     |
| `file`          | ファイルオブジェクト     | `open("file.txt")`      |
| `map`, `filter` | 関数的操作を行うイテレーター | イテレーターでもある              |

---

> ### 特殊な注意点

* **`dict`**：直接for文に渡すとキーが対象
  → `.items()` で `(key, value)` に、`.values()` で値のみも可
* **`set`**：順序が保証されない
* **`range`**：実体を保持せず、遅延評価される

---

> ### ではイテレーター（iterator）とは

* **繰り返し処理を1つずつ進めるためのオブジェクト**
* `__iter__()` に加え `__next__()` を持つ
* `next()` で次の要素を取得、終われば `StopIteration` を発生

```python
it = iter([1, 2])
next(it)  # 1
next(it)  # 2
next(it)  # StopIteration
```

---

> ### 違いの一覧

| 特徴           | イテラブル             | イテレーター        |
| ------------ | ----------------- | ------------- |
| `__iter__()` | ○（必須）             | ○（必須、自分自身を返す） |
| `__next__()` | ×                 | ○（必須）         |
| `next()` 使用  | ×（要 `iter()` が必要） | ○（そのまま可能）     |
| `for` ループ使用可 | ○                 | ○             |
| 状態保持         | ×（毎回初期化）          | ○（進行状態を保持）    |

---

> ## イテラブルをイテレーターに変換して使う例

---

> ### 基本：`iter()` で明示的に変換

```python
data = [10, 20, 30]  # list はイテラブル

it = iter(data)      # イテレーターに変換

print(next(it))  # 10
print(next(it))  # 20
print(next(it))  # 30
print(next(it))  # StopIteration 発生
```



> ### `for` での処理と等価な処理

```python
# 通常の for 文
for x in [10, 20, 30]:
    print(x)

# 同等な処理（内部的にはこれが行われている）
it = iter([10, 20, 30])
while True:
    try:
        x = next(it)
        print(x)
    except StopIteration:
        break
```

---

> ### 応用：ファイルオブジェクトの逐次読み出し

```python
with open("example.txt", "r", encoding="utf-8") as f:
    it = iter(f)  # ファイルもイテラブル → イテレーター化

    print(next(it).strip())  # 1行目
    print(next(it).strip())  # 2行目
```

📌 ファイルはすでにイテレーターとして機能するが、`iter(f)` により明示的に取得可能。

---

> ### 応用：条件付きで途中まで読む

```python
nums = [1, 2, 3, 4, 5]
it = iter(nums)

for val in it:
    if val > 3:
        break
    print(val)  # → 1, 2, 3

# 続きの値を取得可能（状態は保持されている）
print(next(it))  # 4
print(next(it))  # 5
```

📌 `iter()` によって得られるイテレーターは**状態を保持**しているため、途中中断・再開が可能。

---

> ### 補足：`iter(callable, sentinel)` の形式

```python
import random

# 0 が出るまで乱数を生成（終了条件つき）
it = iter(lambda: random.randint(0, 5), 0)

for x in it:
    print(x)
```

📌 callable を使って「終了条件つきイテレーター」を作る特殊用法。

---

> ### 判別方法

```python
from collections.abc import Iterable, Iterator

isinstance([1, 2, 3], Iterable)   # True
isinstance([1, 2, 3], Iterator)   # False
isinstance(iter([1, 2, 3]), Iterator)  # True
```

---



