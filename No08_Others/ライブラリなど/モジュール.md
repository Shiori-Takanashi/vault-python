
---

# 🧩 Python モジュール 詳細解説

---

## 1. 🔁 モジュールとは何か

モジュールとは：

> **Pythonコードを1つの `.py` ファイルにまとめた再利用可能な単位。**

Pythonの実行環境では、**1ファイル = 1モジュール**として扱われる。

例：

```python
# ファイル構造
my_module.py      ← モジュール
```

```python
# 呼び出し元
import my_module
my_module.some_function()
```

---

## 2. 🧱 モジュールの構造と実体

Pythonモジュールは**以下のような構成を持つ**：

```python
# my_module.py

PI = 3.14

def area(r):
    return PI * r * r

class Circle:
    ...
```

呼び出し元で：

```python
import my_module
my_module.area(2)
```

---

## 3. 📦 モジュールの種類

| 種類          | 説明             | 例                     |
| ----------- | -------------- | --------------------- |
| 標準モジュール     | Pythonに同梱されている | `math`, `json`, `sys` |
| サードパーティ     | pipでインストール     | `requests`, `numpy`   |
| ユーザー定義モジュール | 自作 `.py` ファイル  | `my_module.py`        |

---

## 4. 📂 モジュールとパッケージの違い

| 項目 | モジュール      | パッケージ                   |
| -- | ---------- | ----------------------- |
| 実体 | `.py` ファイル | ディレクトリ（＋ `__init__.py`） |
| 役割 | 関数・クラスの集約  | モジュールの集約（論理単位）          |

### 構成例

```
myproject/
├── main.py
├── utils.py         ← モジュール
└── models/          ← パッケージ
    ├── __init__.py
    └── user.py      ← モジュール
```

使い方：

```python
from models import user
import utils
```

---

## 5. 🔧 インポート構文

| 構文                    | 説明                                |
| --------------------- | --------------------------------- |
| `import foo`          | `foo` モジュールを丸ごと読み込む               |
| `import foo as bar`   | 別名をつけて読み込む                        |
| `from foo import bar` | `foo` モジュールから `bar`（関数・変数）を直接取り出す |
| `from foo import *`   | `foo` の中身すべてを名前空間に展開（非推奨）         |

---

## 6. 📍 モジュールの探索場所（importの解決順序）

モジュールは以下の順で探索される：

1. 実行スクリプトと同じディレクトリ
2. `PYTHONPATH` 環境変数に指定されたディレクトリ
3. 標準ライブラリディレクトリ
4. `site-packages`（pipなどで入れたパッケージ）

内部的には `sys.path` に格納されている：

```python
import sys
print(sys.path)
```

---

## 7. 🧭 絶対インポートと相対インポート

### ✅ 絶対インポート（推奨）

```python
from myproject.models import user
```

明確な階層での指定。

---

### ⚠ 相対インポート（パッケージ内部で使われる）

```python
from . import user       # 同じディレクトリ
from ..utils import log  # 1階層上の utils.py
```

> `python -m` 実行でないと壊れることがある。

---

## 8. 🧪 実行と `__name__`

```python
# my_module.py
if __name__ == "__main__":
    print("モジュールが直接実行された")
```

| 状況                    | `__name__` の値 |
| --------------------- | ------------- |
| `python my_module.py` | `"__main__"`  |
| `import my_module`    | `"my_module"` |

→ テスト用のコードを分離可能

---

## 9. 🧠 モジュールを作る意義

| メリット | 内容               |
| ---- | ---------------- |
| 再利用性 | 同じ関数を複数スクリプトで使える |
| 保守性  | 大きなスクリプトを分割可能    |
| 可読性  | ファイルごとに責務を明確にできる |
| テスト性 | 関数単位でテストしやすくなる   |

---

## ✅ 結論

* **モジュール = `.py` ファイル単位の再利用可能なコード**
* `import` で取り込めばどこでも使用可能
* 規模が大きくなれば **パッケージ** での整理が必要
* 実行用とモジュール用を切り分ける際は `if __name__ == "__main__"` を使う

---

